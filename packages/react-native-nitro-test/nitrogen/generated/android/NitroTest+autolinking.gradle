///
/// NitroTest+autolinking.gradle
/// This file was generated by nitrogen. DO NOT MODIFY THIS FILE.
/// https://github.com/mrousavy/nitro
/// Copyright Â© 2025 Marc Rousavy @ Margelo
///

/// This is a Gradle file that adds all files generated by Nitrogen
/// to the current Gradle project.
///
/// To use it, add this to your build.gradle:
/// ```gradle
/// apply from: '../nitrogen/generated/android/NitroTest+autolinking.gradle'
/// ```

logger.warn("[NitroModules] ðŸ”¥ NitroTest is boosted by nitro!")

android {
  sourceSets {
    main {
      java.srcDirs += [
        // Nitrogen files
        "${project.projectDir}/../nitrogen/generated/android/kotlin"
      ]
    }
  }
}

gradle.taskGraph.whenReady { taskGraph ->
    println "ðŸ”¥ Building Rust Module"
    // Script is generated in nitrogen/generated/android/scripts/, relative to android/ directory
    def scriptPath = new File(projectDir, '../nitrogen/generated/android/scripts/rn-build-start.sh')
    def process = ['sh', scriptPath.absolutePath].execute(null, projectDir)
    process.in.eachLine { line -> println line }
    process.err.eachLine { line -> System.err.println line }
    process.waitFor()
    if (process.exitValue() != 0) {
        throw new GradleException("Rust build failed with exit code ${process.exitValue()}")
    }
}
